

<div class="d-flex justify-content-center align-items-center w-100 mt-5">
@if (error$ | async; as error) {
  <div class="alert alert-danger mb-2 my-3">
   {{ error.replace('Error: ', '') }}
  </div>
}
</div>
<div class="d-flex justify-content-center align-items-center min-vh-100 w-100">
<form [formGroup]="form" (ngSubmit)="submit()" class="card p-4 shadow-sm" style="width:100%;max-width:420px;">

  <h3 class="text-center mb-3">Sign up</h3>

  <div class="d-flex gap-3 flex-column">

    <!-- USERNAME -->
    <div class="form-group position-relative">
      <label class="my-1">Username</label>
      <input
        formControlName="username"
        class="form-control"
        placeholder="Enter your username"
      />

      <div class="position-absolute">
        @if (form.get('username')?.dirty && form.get('username')?.errors; as e) {

          @if (e['mustStartWithLetter']) {
            <small class="text-danger">Must start with a letter</small>

          } @else if (e['minLength']) {
            <small class="text-danger">Minimum 5 characters</small>

          } @else if (e['noSpaces']) {
            <small class="text-danger">Spaces not allowed</small>

          } @else if (e['invalidChars']) {
            <small class="text-danger">Only letters, numbers and _ allowed</small>
          }

        }
      </div>
    </div>

    <!-- EMAIL -->
    <div class="form-group position-relative">
      <label class="my-1">Email address</label>
      <input
        formControlName="email"
        type="email"
        class="form-control"
        placeholder="Enter your email"
      />

      <div class="position-absolute">
        @if (form.get('email')?.dirty && form.get('email')?.hasError('email')) {
          <small class="text-danger">Invalid email address</small>
        }
      </div>
    </div>

    <!-- PASSWORD -->
    <div class="form-group position-relative">
      <label class="my-1">Password</label>
      <input
        formControlName="password"
        type="password"
        class="form-control"
        placeholder="Enter your password"
      />

      <div class="position-absolute">
        @if (form.get('password')?.dirty || form.get('password')?.touched) {

          @if (form.get('password')?.errors; as e) {

            @if (e['required']) {
              <small class="text-danger">Password is required</small>

            } @else if (e['minLength']) {
              <small class="text-danger">At least 12 characters</small>

            } @else if (e['uppercase']) {
              <small class="text-danger">Add one uppercase letter</small>

            } @else if (e['lowercase']) {
              <small class="text-danger">Add one lowercase letter</small>

            } @else if (e['digit']) {
              <small class="text-danger">Add one number</small>

            } @else if (e['special']) {
              <small class="text-danger">Add one special character</small>
            }

          } @else {

            @if ((form.get('password')?.value?.length ?? 0) < 15) {
              <small class="text-warning">
                Consider 15+ characters for stronger security
              </small>
            } @else {
              <small class="text-success">
                Password looks strong
              </small>
            }

          }
        }
      </div>
    </div>

  </div>

  <button
    type="submit"
    class="btn btn-primary my-4 w-100"
    [disabled]="form.invalid"
  >
    Submit
  </button>

  <div class="text-center mt-2">
    <span class="text-muted">Already have an account?</span>
    <a routerLink="/signin" class="ms-1 fw-semibold text-decoration-none">
      Sign in
    </a>
  </div>

</form>
</div>

